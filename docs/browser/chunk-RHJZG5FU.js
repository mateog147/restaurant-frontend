import{a as O}from"./chunk-NK4DK5A2.js";import{Ab as _,Ba as u,Bb as v,Db as C,Eb as P,Fa as p,Kb as x,Ma as c,Oa as r,Pa as n,Ta as m,Xa as i,Ya as d,a as g,b as h,fb as f,hb as b,sa as o,wa as l}from"./chunk-565KPZUI.js";function y(e,a){if(e&1&&(r(0,"tr")(1,"td"),i(2),f(3,"date"),n(),r(4,"td"),i(5),n(),r(6,"td"),i(7),n()()),e&2){let t=a.$implicit;o(2),d(b(3,3,t.createdAt,"yyyy-MM-dd")),o(3),d(t.quantity),o(2),d(t.ingredientName)}}function S(e,a){if(e&1&&(r(0,"table",6)(1,"thead")(2,"tr")(3,"th"),i(4,"Date"),n(),r(5,"th"),i(6,"Quantity"),n(),r(7,"th"),i(8,"Product"),n()()(),r(9,"tbody"),p(10,y,8,6,"tr",7),n()()),e&2){let t=m();o(10),c("ngForOf",t.filtered)}}function w(e,a){e&1&&(r(0,"div",8),i(1,"Loading..."),n())}function E(e,a){e&1&&(r(0,"div",9),i(1,"No purchases found."),n())}function N(e,a){if(e&1&&(r(0,"div",9),i(1),n()),e&2){let t=m();o(),d(t.error)}}var I=class e{constructor(a,t){this.http=a;this.orderService=t}purchases=[];filtered=[];loading=!0;error="";search="";ngOnInit(){this.http.get("https://restaurant-api-gateway-hih5.onrender.com/cellar/movements/in").subscribe({next:a=>{this.purchases=a,this.orderService.getIngredients().subscribe(t=>{this.purchases=a.map(s=>h(g({},s),{ingredientName:t.find(M=>M.uniqueId==s.ingredientId)?.name||"Unknown"})),this.filtered=this.purchases,this.loading=!1})},error:()=>{this.error="Failed to load purchases.",this.loading=!1}})}static \u0275fac=function(t){return new(t||e)(l(x),l(O))};static \u0275cmp=u({type:e,selectors:[["app-purchases"]],decls:9,vars:4,consts:[[1,"purchases-wrapper"],[1,"purchases-title"],[1,"subtitle"],["class","purchases-table",4,"ngIf"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[1,"purchases-table"],[4,"ngFor","ngForOf"],[1,"loading"],[1,"error"]],template:function(t,s){t&1&&(r(0,"div",0)(1,"h1",1),i(2,"Purchase History"),n(),r(3,"div",2),i(4,"View and manage all your past purchases from the market."),n(),p(5,S,11,1,"table",3)(6,w,2,0,"div",4)(7,E,2,0,"div",5)(8,N,2,1,"div",5),n()),t&2&&(o(5),c("ngIf",!s.loading&&s.filtered.length),o(),c("ngIf",s.loading),o(),c("ngIf",!s.loading&&!s.filtered.length),o(),c("ngIf",s.error))},dependencies:[P,_,v,C],styles:[".purchases-wrapper[_ngcontent-%COMP%]{margin:2rem auto;max-width:900px;background:#18191b;color:#fff;min-height:100vh}.purchases-title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;margin-bottom:.5rem}.subtitle[_ngcontent-%COMP%]{color:#a0a0a0;margin-bottom:2rem}.search-bar-wrapper[_ngcontent-%COMP%]{margin-bottom:1.5rem}.search-bar[_ngcontent-%COMP%]{width:100%;padding:.8rem 1.2rem;border-radius:8px;border:none;background:#232427;color:#fff;font-size:1rem}.purchases-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;background:#232427;border-radius:12px;overflow:hidden;color:#fff;font-size:1.1rem;box-shadow:0 2px 24px #0000001f}.purchases-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .purchases-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.2rem;text-align:left}.purchases-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#232427;font-weight:600;border-bottom:2px solid #323338}.purchases-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:not(:last-child)   td[_ngcontent-%COMP%]{border-bottom:1px solid #323338}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{color:#ffb347;margin-top:2rem}"]})};export{I as PurchasesComponent};
